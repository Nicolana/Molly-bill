# 语音输入功能使用指南

## 功能概述

新的语音输入功能采用微信风格的交互设计，提供直观、易用的语音录制体验。支持最长60秒的语音录制，并提供实时的视觉反馈。

## 使用方法

### 1. 进入语音模式

在聊天界面底部，点击麦克风图标（🎤）切换到语音模式。

**文本模式界面：**
```
[🎤] [📷] [文本输入框] [发送]
```

**语音模式界面：**
```
[⌨️] [📷] [按住 说话 - 大按钮]
```

### 2. 开始录音

在语音模式下，**按住**大按钮开始录音：

- 按住按钮立即开始录音
- 界面会显示录音状态和实时波形
- 显示录音时长和剩余时间

### 3. 结束录音

**松开按钮**完成录音：

- 录音会自动发送给AI处理
- 系统会显示"正在处理语音..."提示
- 识别完成后显示识别结果

### 4. 取消录音

如果想取消录音，可以：

1. **向上滑动**到红色取消区域
2. 当看到"松开取消"提示时松开按钮
3. 录音将被取消，不会发送

## 界面说明

### 录音状态界面

```
┌─────────────────────────────┐
│     [❌] 松开取消           │ ← 红色取消区域
├─────────────────────────────┤
│  ████ ██ ████ █ ███  0:15   │ ← 实时波形 + 时长
│     正在录音...             │ ← 状态提示
│  最长支持60秒语音 (45秒)    │ ← 剩余时间
└─────────────────────────────┘
```

### 视觉反馈

- **绿色波形**：正常录音状态
- **红色区域**：取消录音区域
- **脉冲动画**：录音按钮动态效果
- **时间显示**：实时录音时长

## 功能特性

### ✅ 支持的功能

- **最长60秒录音**：自动停止并提示
- **最短1秒限制**：过短录音会被忽略
- **实时波形显示**：动态音频可视化
- **滑动取消**：向上滑动取消录音
- **触摸优化**：支持移动端触摸操作
- **权限管理**：自动请求麦克风权限

### ⚠️ 使用限制

- **需要HTTPS**：语音录制需要安全连接
- **需要权限**：首次使用需授权麦克风
- **浏览器支持**：需要支持MediaRecorder API
- **网络要求**：需要网络连接进行语音识别

## 常见问题

### Q: 为什么无法录音？

**A:** 可能的原因：
1. 未授权麦克风权限 → 检查浏览器权限设置
2. 非HTTPS环境 → 确保使用HTTPS访问
3. 浏览器不支持 → 更新到最新版本浏览器
4. 麦克风被其他应用占用 → 关闭其他音频应用

### Q: 录音没有声音怎么办？

**A:** 检查步骤：
1. 确认麦克风设备正常工作
2. 检查系统音量和麦克风音量
3. 尝试在其他应用中测试麦克风
4. 重新授权麦克风权限

### Q: 如何重新授权麦克风权限？

**A:** 操作步骤：
1. 点击浏览器地址栏左侧的锁图标
2. 找到麦克风权限设置
3. 选择"允许"或"询问"
4. 刷新页面重新尝试

### Q: 语音识别不准确怎么办？

**A:** 优化建议：
1. 在安静环境中录音
2. 清晰、正常语速说话
3. 靠近麦克风录音
4. 避免背景噪音干扰

### Q: 录音时间太短被忽略？

**A:** 解决方法：
- 确保录音时长至少1秒
- 按住按钮时间要足够长
- 不要过快松开按钮

## 技术要求

### 浏览器支持

| 浏览器 | 最低版本 | 支持状态 |
|--------|----------|----------|
| Chrome | 60+ | ✅ 完全支持 |
| Firefox | 55+ | ✅ 完全支持 |
| Safari | 11+ | ✅ 完全支持 |
| Edge | 79+ | ✅ 完全支持 |

### 移动端支持

| 平台 | 支持状态 | 备注 |
|------|----------|------|
| iOS Safari | ✅ 支持 | iOS 11+ |
| Android Chrome | ✅ 支持 | Android 6+ |
| 微信浏览器 | ✅ 支持 | 最新版本 |
| 支付宝浏览器 | ✅ 支持 | 最新版本 |

### 系统要求

- **操作系统**：Windows 10+, macOS 10.14+, iOS 11+, Android 6+
- **网络连接**：需要稳定的网络连接
- **存储空间**：临时存储录音文件
- **麦克风设备**：内置或外接麦克风

## 隐私说明

### 数据处理

- 录音数据仅用于语音识别
- 不会永久存储录音文件
- 识别完成后立即删除音频数据
- 遵循相关隐私保护法规

### 权限使用

- 仅在录音时访问麦克风
- 不会在后台录音
- 用户可随时撤销权限
- 透明的权限使用说明

## 更新日志

### v2.0.0 (当前版本)
- ✨ 全新微信风格界面
- ✨ 支持滑动取消录音
- ✨ 实时波形动画显示
- ✨ 优化移动端触摸体验
- 🐛 修复录音时长计算问题
- 🐛 修复权限检查逻辑

### v1.0.0
- 🎉 基础语音录制功能
- 🎉 语音识别集成
- 🎉 简单的录音界面

---

如有其他问题，请联系技术支持或查看详细的技术文档。
